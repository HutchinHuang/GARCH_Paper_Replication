% Estimate J and kappa, with regard to GARCH(1,1)
function [] = MatJ(omega,alpha,beta,eps)
n = length(eps);
sigma2 = zeros(n,1);
sigma2(1) = omega;
dersigma2 = zeros(3,n);
dersigma2(:,1) = [1;0;0];
for t = 2:n
    sigma2(t)=omega+alpha*eps(t-1).^2+beta*sigma2(t-1);
    dersigma2(1:3,t)=[1;eps(t-1)^2;sigma2(t-1)];
    dersigma2(1:3,t)=dersigma2(1:3,t)+beta*dersigma2(1:3,t-1);
end

Jmat=zeros(3,3);

for t = 2:n
Jmat=Jmat+(dersigma2(1:3,t)/sigma2(t))*(dersigma2(1:3,t)/sigma2(t))';
end

Jmat=Jmat/n;
eta=zeros(n,1);
eta(1:n)=eps(1:n)/sqrt(sigma2(1:n))
#mean(eta[2:n]); mean(eta[2:n]^2)
kappa.eta=mean(eta[2:n]^4)
I=Jmat[2:3,2:3]-Jmat[2:3,1]%*%t(Jmat[2:3,1])/Jmat[1,1]
list(kappa=kappa.eta,Jmat=Jmat,Imat=I)
end
end