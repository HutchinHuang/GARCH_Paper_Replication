% Main Programme to Get Table IV.
omega0=0.1;
beta0=0.8;
df=7;
alphavec=c(0.18,0.20,0.22,0.25752,0.28,0.30,0.31);
niter=length(alphavec);
njter=c(500,2000,4000);
for jter = 1:length(njter)
n=njter(jter);
nrep=1000;
pval_matrix = zeros(niter,nrep);
para_omega=zeros(niter,nrep);
para_alpha=zeros(niter,nrep);
para_beta=zeros(niter,nrep);
for i = 1:niter
    alpha0=alphavec(i);
    for j = 1:nrep
        ser=garch_sim_switch(n, omega0,  alpha0, beta0,df);
        resestimgarch11 = estimgarch11ettest(abs((1+0.1/2-0.1*runif(1))*omega0),
        abs((1+0.1/2-0.1*runif(1))*alpha0),abs((1+0.1/2-0.1*runif(1))*beta0),
        ser)
        pval[i,j]=resestimgarch11$pval
        para.omega[i,j]=resestimgarch11$coef[1]
        para.alpha[i,j]=resestimgarch11$coef[2]
        para.beta[i,j]=resestimgarch11$coef[3]
    end
end
freq.rej=rep(0,niter)
for (i in 1:niter) 
freq.rej[i]=100*length(which(pval[i,]< 0.05))/nrep
end
print(freq.rej)
end
